<h2>User list</h2>

<script>
    var parsedToken = isLoggedIn();
    if (parsedToken){
        //if admin role -> Request stuff from api
        var test = parsedToken['roles'];
        if(jQuery.inArray("admin", test) !== -1) {
            var data = {};
            data['service'] = "user";
            data['action'] = "list";
            sendData(data);
        }
    }
    else {
        $("#app").html('<button type="button" onclick="var page = \'/\';getPage(page);history.pushState(page, page, page);">Error Go Home</button>');
    }

    function onResponse(data){
        if (data['payload']!='')
        {
            var payload = jQuery.parseJSON( data['payload'] );
            $("#app").append("<ul id='userlist'></ul>");
            //foreach item in payload
            payload['payload'].forEach ((user, index) => {
                $("#userlist").append("<li><span>" +user['user_id'] + "</span><a>" + user['user_name'] + "</a><span>" + user['user_email'] + "</span><span> ----------->" + user['user_roles'] + "</span><a style='float:right;'>Delete</a><a style='float:right;'>Edit</a></li>");
            });
        }
        $("#app").append('<button type="button" onclick="var page = \'/user/register\';getPage(page);history.pushState(page, page, page);">Create new user.</button>');
    }
    </script>
