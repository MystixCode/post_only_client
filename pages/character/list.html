<h2>Character list</h2>

<script>
    var token = localStorage.getItem("token");
    if (token){
        var parsedToken = parseJWT(token)
        if (parsedToken['username']){ //IF "LOGGEDIN"
            //Request stuff from api
            var data = {};
            data['service'] = "character";
            data['action'] = "list";
            sendData(data); //TODO send and check token on server
        }
    }
    else {
        //alert('not logged in - no token found - TODO: go to login');
        $("#app").html( '<button type="button" onclick="var page = \'/user/login\';getPage(page);history.pushState(page, page, page);">You are not logged in! Go to login page here</button>' );
    }

    function onResponse(data){
        if (data['payload']!='')
        {
            $("#app").html("<ul id='characterlist'></ul>");
            //foreach item in payload
            data['payload'].forEach ((character, index) => {
                $("#characterlist").append("<li><a >" + character[1] + "</a><a style='float:right;'>Delete</a><a style='float:right;'>Edit</a></li>");
            });
        }
        $("#app").append('<button type="button" onclick="var page = \'/character/add\';getPage(page);history.pushState(page, page, page);">Create new char.</button>');
    }
    </script>
